# FBI 針對史諾登電郵供應商 Lavabit 的加密密鑰

2013年6月，兩名FBI探員敲響了Ladar Levison位於德州的住宅大門。探員希望取得愛德華·史諾登在莫斯科謝列梅捷沃機場召開新聞發布會時所使用的一個電郵帳戶的存取權，而該帳戶正由Levison的公司Lavabit運行。Levison在舊金山長大，十歲時組裝了第一台電腦，還在讀書時運營一個公告板。14歲時，Levison悄然離家，前往參加DefCon大會。Lavabit提供安全電郵服務，其設計目的在於挫敗美國的攔截與存取工具──數據在傳輸及靜止時均受到加密保護，而Lavabit自身無法閱讀電郵內容，因此即便接到搜查令也無法將內容交予政府。當時，Lavabit在全球擁有41萬客戶。其網站上寫道：

> Lavabit相信，一個公民社會依賴於思想的自由、公開且私密的流通。PATRIOT法案所推行的監控方式會限制這種思想的流通，因為它令那些擔心報復的人卻步。為了對抗這種寒蟬效應，Lavabit開發了其安全電郵平台。我們認為電郵已經演變成健康民主社會中傳遞思想的重要渠道。正因為電郵的重要性，我們才如此努力保護私人電郵不被竊聽。

儘管如此，Levison並非完全反建制。Lavabit僅向付費用戶提供完全加密的服務；網站指出，「付費客戶會留下金錢痕跡，若帳戶用於非法用途，這條金錢線索可用於追查帳戶擁有者。」然而，金錢痕跡是可以被掩蓋的，這一點Levison當然十分清楚。Levison表示，他曾配合過「十幾道」針對特定用戶的法院命令。

FBI探員向Levison出示了一份法院命令，命令其協助FBI在Lavabit網路上部署攔截技術，以便截取史諾登帳戶的元數據。法官要求此攔截命令必須保密，因為其外洩可能會讓史諾登察覺政府調查，進而放棄使用Lavabit的服務。當法院文件最終公開時，調查目標被塗黑，而保密令又阻止Levison傳達這些信息；直到2016年，因政府文件塗黑錯誤，公眾才確信史諾登正是調查目標。隨後，法院命令範圍擴大，要求攔截與史諾登相關的所有內容。命令指出：「Lavabit必須立即向FBI探員提供所有必要的資訊、設施與技術協助，以完成安裝及使用該攔截／監聽裝置。」司法部認為，「使用」一詞涵蓋了提供解密密鑰，使FBI能「使用」攔截到的產品——Levison則對這一解釋提出異議。司法部記載，Levison表示他有技術能力解密流量，但他不願「破壞Lavabit自身的系統」。Levison拒絕遵從該命令，告知FBI探員他希望先諮詢律師，了解自己的選項。他的主要反對理由在於，一旦交出Lavabit的加密密鑰，便無法技術上阻止FBI攔截其41萬客戶所有流量。Levison稱，探員「說他們需要……客戶密碼（這些密碼是以安全方式傳送的），以便他們能存取使用我公司加密儲存功能的用戶的明文訊息。」雖然FBI被告知只會存儲經合法授權的、屬於史諾登帳戶的數據，但這對Levison來說並不令人滿意。

法官Theresa Buchanan命令Levison必須遵從攔截要求，並警告他將面臨法院所能施加的任何處罰；在2013年6月28日，該命令末尾以幾乎潦草難辨的字跡附加了一句話，「包括可能構成藐視法庭罪」。FBI聲稱在隨後的數日與數週中曾多次試圖與Levison會面，但Levison表示自己與FBI保持著定期聯繫。7月16日，Levison被傳喚到維吉尼亞州法院，要求「說明Lavabit為何未能遵從命令」，並指示他攜帶「在lavabit.com任何SSL或TLS連線中使用的公開與私密加密密鑰」參加聽證會。

這並非FBI首次試圖取得目標加密密鑰。最早有關FBI試圖取得目標加密密鑰的證據出現在2001年，當時在起訴涉嫌放高利貸的Nicodemo Scarfo時，法官Nicholas Politan迫使FBI披露如何存取被告使用PGP加密的通訊。FBI解釋說，在相關法院授權下，他們秘密進入Scarfo辦公室，於其電腦上安裝了竊取密鑰的惡意軟體。FBI實驗室配置了這種基於「先前開發技術」的密鑰記錄系統（key logger system, KLS）。這項FBI程式於1999年5月被部署到嫌疑人電腦上，表明FBI在電腦滲透方面的嘗試甚至可追溯到更早之前。由於取回數據需要實際接觸電腦，FBI探員不得不多次秘密返回Scarfo辦公室以提取數據，這些數據包括PGP密碼短語及其他「與密鑰相關的信息」。

2001年也曾有報導指出，FBI正在研發一項代號為MAGIC LANTERN的能力，即一種用於遠程竊取用戶加密密鑰及相關密鑰數據的惡意軟體。FBI的Paul Bresson證實了MAGIC LANTERN的存在，但表示「這只是一個工作平台項目……我們不能討論，因為它還在開發中。」2007年的法院文件顯示，FBI的能力已演變為遠程作業，FBI不再依賴破門而入的技術，這使得該技術具有可擴展性與更高的反應速度。文件中記錄了一起案件，嫌犯透過電子郵件發送炸彈威脅給華盛頓一所高中，並嘲弄FBI調查人員稱其缺乏追蹤數位足跡的技能。FBI獲得搜查令後，部署了一種名為電腦與網際網路協定位址驗證器（CIPAV）的工具，用以識別嫌犯。CIPAV通過FBI控制的「電子消息程式」傳送，能夠將目標設備的真實IP地址、MAC地址、正在執行的程式清單、作業系統、網路瀏覽器、註冊的電腦名稱、當前登入用戶以及最近訪問的URL等信息傳回FBI。該行動最終成功，嫌犯被確認是一名該校學生。

在 Levison 的案例中，MAGIC LANTERN 或類似能力並非選項——再者，Levison 的技術防禦極有可能比一般調查目標更為先進，他本人並非調查對象，而只是第三方。因此，FBI 必須要求 Levison 交出加密密鑰。當 FBI 探員試圖將傳票送達給他時，探員表示他們敲響了 Levison 的門，卻只目擊到 Levison 從公寓後門走出、上車後迅速駛離。聽證會前，Levison 提出由他自己進行攔截並將數據交給 FBI 的方案，但他要求酬金 4000 美元以補償撰寫必要程式碼的工作，並提出在法院命令規定的 60 天期限結束時交付攔截產品，同時還可選擇以額外 1500 美元補償更頻繁地提供攔截數據。此外，Levison 還要求 2000 美元以重發其客戶的 SSL 證書，儘管 FBI 不清楚這是否包含在 4000 美元之內。FBI 認為這些要求不屬於「合理費用」的範疇，依據的是筆錄器（pen register）相關法規。FBI 進一步表示，Levison 可以「僅僅允許 FBI 安裝筆錄器裝置並交出加密密鑰」來滿足命令要求。司法部要求法官在聽證會後，每逾期一天便對 Levison 處以 1000 美元的罰款。聽證會當天早晨，司法部還特別獲得了一張針對 Lavabit 加密密鑰的搜查令，以解決初始筆錄器要求中的任何模糊之處。Levison 請求 Hilton 法官解封案件，以便進行公開辯論，但 Hilton 拒絕了，理由是這會危及調查。Levison 企圖申請撤銷對其加密密鑰的搜查令，他主張：「如果法院要求交出主密鑰，Lavabit 將付出最終代價——失去客戶的信任與業務。」Levison 還辯稱，由於加密密鑰將使得所有 Lavabit 用戶均可被監控，因此這張搜查令過於籠統，違反了第四修正案。Levison 的律師向 Claude Hilton 法官請求一項機制，確保政府不會超出搜查令範圍行事，並提出由 Levison 自行執行攔截作業作為解決方案。Hilton 法官回應道：「你想以一種必須讓政府信任你的方式來進行數據篩選——以便提取正確的數據，而你卻不信任政府，那麼政府又怎會信任你呢？」FBI 向法官保證，他們的軟體將會篩選數據，只提取與史諾登相關的通訊。最終，法院駁回了 Levison 的請求，命令必須將加密密鑰交給 FBI。Levison 算是以某種方式遵從了命令——8 月 2 日，他交付了一份僅有 11 頁、且字體小至 4 號、難以辨識的加密密鑰文件給 FBI。政府隨後致函法官，要求從 8 月 5 日起對 Levison 每逾期一天處以 5000 美元的罰款，Hilton 法官最終同意了這一要求。8 月 7 日，Levison 將加密密鑰的電子檔案送往 FBI 位於達拉斯的辦公室——同一天他也關閉了 Lavabit 公司。隨著該公司宣告結束營運，加密密鑰對 FBI 來說也就失去了作用。Levison 在 Lavabit 網站上留言，表示他被迫「做出了一個艱難的決定：要麼成為對美國人民犯罪的共犯，要麼放棄近十年來的艱苦努力，關閉 Lavabit。」他解釋說，法律規定使他無法公開講述導致其做出此決定的經過，並在留言結尾警告道：「除非國會採取行動或有強有力的司法先例，我強烈建議大家不要把自己的私人數據托付給與美國有實體聯繫的公司。」Levison 隨後解釋道：

> 「如果聯邦調查局早知道我打算關閉服務，他們就會取得一份法院命令，要求我繼續運營該服務。如果我在收到此類命令後關閉服務，我幾乎肯定會被控妨礙司法。我聽說其他服務供應商也曾面臨類似情況，威脅關閉服務後卻收到這類命令。」

至於其他公司是誰，目前尚不清楚。位於馬里蘭州的 Silent Circle，其提供類似安全電郵服務，也宣布將於 8 月 9 日關閉，並告知其用戶：「我們看到了局勢的變化，決定立即關閉 Silent Mail。我們並未收到任何政府的傳票、搜查令或安全函件，這也是我們採取行動的原因。」到了10月，Lavabit 的記錄被解封，讓公眾得以了解導致 Lavabit 關閉的經過。電子前哨基金會的 Jennifer Lynch 評論道：「取得一個服務的私有密鑰的搜查令，就好比取得一張搜查整個城市所有民宅以尋找一名嫌疑犯文件的搜查令。」史諾登表示，他從 Lavabit 的行動中得到了「啟發」，並評論道：「Google、Facebook、Microsoft、Yahoo、Apple 以及其他網際網路巨頭的員工與領導層，都必須問問自己，為什麼他們不像小型企業那樣為我們的利益而戰。」政府方面則沒有發表評論。

Levison 對其藐視法庭的制裁提出上訴，他的辯護基金籌集了超過 10 萬美元，而最終總額達到 15 萬美元。司法部向法院提交的簡報中論述道：

> 「正如企業無法因為關上前門就阻止執行搜查令，電子通訊服務供應商也不能藉由拒絕提供其系統必要資訊來阻撓法院下達的電子監控命令。」

由於 Lavabit 其他用戶的數據不在搜查令範圍內，政府重申他們的觀點：「那些不在搜查令範圍內的其他資訊，即便是使用同一組密鑰加密，也並不相關……所有其他數據都將通過電子方式過濾，不會被人工查看。」司法部在給其他可能考慮對抗的公司的訊息中寫道：「將一個企業宣稱為『安全』並不意味著它可以忽視美國地區法院的命令。」Levison 的上訴最終被駁回。Levison 評論這次經歷道：

> 「法院絕不應允許在秘密遮蔽下處理如此重大的事務，否則我們將喪失有意義的正當法律程序。如果我們允許政府繼續在秘密中運作，遲早你或你所愛的人也會發現自己置身於一個秘密法庭中，孤零零地，且無法享有那些本應是人民防範國家權力濫用的有效保障。」

Levison 還談到保護愛德華·史諾登的問題，他說：

>「我很慶幸當初被追查的人不是一個墮落者或惡棍，而是我不得不替他辯護的人……我擔心的是，我會被迫替一個恐怖分子、或一個販賣兒童色情的團伙、或有組織犯罪替辯，或其他類似組織辯護。但最終被追查、導致關閉服務的，卻是一位揭露政府濫權的告密者。這正是我認為隱私如此重要的根本原因。」

Lavabit 的經歷預示著即將在加州爆發的 Apple San Bernardino 案件；不同之處在於，Apple 擁有一支龐大的律師團隊，並在全世界注目下公開辯論，而非在密封的法庭中進行。